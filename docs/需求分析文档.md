# 需求分析文档

## 项目背景

### 基本背景

天气情况与我们的生活息息相关，天气的变化有时也会对我们的生活计划和决策起到影响作用，关注天气变化情况也逐渐成为更多人日常生活中的必备事项。在移动互联网和智能手机普及之前，我们只能守着电视观看天气预报，通过天气预报来决定明天穿多少、要不要带雨具、空气质量情况是否需要带口罩等。如今，智能手机普及，天气类网站/APP也应运而生，用户可以随时随地查看天气情况，各种天气数据一目了然。随着越来越多的天气网站/APP现身市场，繁荣的景象也促使参与者们不断优化功能以迎合更加严苛的需求。

因此，考虑到如上因素，一个基于天气历史数据的分析预测系统是很有必要的，它可以通过历史气象数据来预测一周的气温走势，之后再使用web页面对分析的结果进行可视化展示。此外，用户管理和角色、权限管理可以大大方便对于整个系统的操作。最终要求开发出一套主要目的为基于天气历史数据进行分析预测并为用户展现预测天气情况的完整系统。

## 可行性分析

### 技术可行性分析

#### 前端

前端现在已经有很成熟的框架可以使用，一方面可以大幅度地降低开发难度，另一方面也是整个系统的架构更加解耦，便于组件的更新和拓展。在本项目中，我们考虑采用以Vue.js和webpack为基础的框架进行搭建；前端UI框架使用商业公司饿了么开发的element-ui，由于是大厂维护，质量可以得到保障。

#### 后端

现如今微服务是一个很流行的概念，即是将系统各部分组成划分为一个个小的模块，他们之间可以较为独立的运行，这同样也是一种松耦合的架构。我们决定采用Python Flask框架，实现RESTful的API，对于数据资源的CRUD可以以一种更加优雅的方式进行。

#### 算法

基于时间序列的算法分析有很多办法，较为传统的方法是进行将数据进行差分，然后利用ARIMA模型进行运算；而深度学习的方法是利用LSTM等网络进行模型训练，之后通过模型运算得出结果。我们决定采用基于tensorflow的LSTM+EMD算法进行数据的分析，可以显著提高预测的准确度，得到更准确的预测值，提升用户体验。

#### 部署

微服务架构除了后端的支持外，更离不开部署的支持。现如今docker容器部署的方式非常热门，便于操作，并且容器之间互不干扰，占用资源也较少。为了实现多个docker容器的统一调配，Kubernetes也是很常用的选择。我们考虑采用基于Jenkins CI和Kubernetes的DevOps进行开发，自动获取每一次commit的代码并进行测试上线，实现从代码到制品的全自动流程。

### 资源可行性分析

获取天气数据的网址：https://www.ncdc.noaa.gov/data-access/land-based-station-data

![](https://codimd.s3.shivering-isles.com/demo/uploads/upload_a3f98344748ade872a1f87fbfc2e2e78.png)

陆地观测是从各大洲各地的仪器中收集的。它们包括温度，露点，相对湿度，降水，风速和风向，能见度，大气压力以及天气事件的类型，例如冰雹，雾和雷声。 NCEI提供与陆基观测相关的广泛服务。其中包括数据收集，质量控制，存档以及消除与城市化和仪器随时间变化等因素相关的偏差。可获得每小时，每小时，每天，每月，每年和多年时标的数据。

### 市场可行性分析

![](https://codimd.s3.shivering-isles.com/demo/uploads/upload_31a5e58b63d73fc4007af800520bb426.png)

在用户关注内容的调查中，七成用户最关注天气状态。天气APP的核心功能就是查看天气状态，这也是用户的基本需求；66.7%的受访者最关注最高温和最低温数据，其中，在昼夜温差较大的北方地区这一现象更为明显;而有远行或旅游计划的用户通常会关注一周天气变化走势，依靠走势来制定外出计划，避开极端天气，做出预判性的决策；只有少数用户会关注降水量、降雪量、湿度和风力风速等内容，这类数据对于大部分人群来说缺乏实质影响，用户只需要知道是否下雨和是否有大风就可以满足基本的出行计划制定的需要。

![](https://codimd.s3.shivering-isles.com/demo/uploads/upload_3a550a3967ff04546cf9c2e8d637523b.png)

天气网站/APP用户使用频率调查显示，每天固定查看天气网站/APP的人数并不多，而随时查看才是大部分用户的使用习惯。天气网站/APP的实时性很强，智能手机的便利性也为此提供基本保障，用户无需养成每日查看天气预报的习惯。利用任何时间都能使用天气网站/APP查询本周、今日甚至当前时间的天气情况。天气网站/APP的便捷性和人们对天气查询功能的依赖程度使天气网站/APP具备得天独厚的发展优势。

通过多方分析认为：天气网站/APP市场仍然有待开发，毕竟工具类APP与人们的生活密切相关，市场规模还有很大的成长空间。各类天气APP应该把目光集中在用户体验上，尤其在网站/APP首页中，操作一定要简单快捷，数据做到精准无误，出色的体验有利于提升用户粘性。小众的天气网站/APP更应如此，此外，除了在天气数据的精准度上多下功夫外，作为工具类应用，天气网站/APP更应不忘本质，多关注用户日常生活中的实际需求，以创新的视角将原本枯燥无味的天气数据变得更有人情味或许会是一个很好的发展方向。

## 详细需求

### 技术需求

前端：Vue.js + Vuex + webpack + websocket

后端：Python Flask + websocket + RESTful API

算法：Python Flask微服务 + Tensorflow + Keras + LSTM + EMD

数据库：MySQL + Redis

### 数据需求

#### 静态数据

- 天气数据集：过去40年间全国各省会城市的天气数据，用以训练天气模型

#### 动态数据

- 预测的天气数据

- 用户数据：
    - 用户名
    - 密码
    - 用户角色
    - 用户描述
    - 用户邮箱

- 角色数据
    - 角色名
    - 角色描述
    - 角色权限

#### 数据采集

- 训练数据集：美国国家海洋和大气管理局（NOAA）取得1980~2020年全国各省会城市每天的天气数据
- 预测的天气数据：通过深度学习网络预测返回
- 用户数据、角色数据：用户输入

### 功能需求

- 用户登录

  | 用例名称     | 用户登录                                                     |
  | :----------- | ------------------------------------------------------------ |
  | **功能简述** | 用户对个人账号进行对系统的登录                               |
  | **用例编号** | 001                                                          |
  | **执行者**   | 系统用户                                                     |
  | **前置条件** | 1. 该用户存在于系统用户名单中<br />2. 用户名、密码的输入     |
  | **后置条件** | 查询用户信息数据库的许可                                     |
  | **涉众利益** | 用户：希望能够完成登录从而获得更多权限<br />系统：需要用户进行登录得以进入后台模块 |
  | **基本路径** | 1. 用户输入用户名及密码<br />2. 用户滑动滑块完成验证<br />3. 用户确认登录<br />4. 系统在数据库中查询用户是否存在匹配<br />5. 系统反馈登录情况 |
  | **拓展路径** | 1. 用户不存在于系统名单内，提示用户<br />2. 用户名与密码不匹配，提示用户<br />3. 未完成滑块验证，提示用户 |
  | **字段列表** | 用户名，密码，是否完成验证                                   |
  | **备注**     |                                                              |

  

- 查询天气预测

  | 用例名称     | 查询天气预测                                                 |
  | :----------- | ------------------------------------------------------------ |
  | **功能简述** | 对未来七天天气预测情况进行查询                               |
  | **用例编号** | 002                                                          |
  | **执行者**   | 全体用户                                                     |
  | **前置条件** | 日期和城市的选择                                             |
  | **后置条件** | 天气预测情况展示在前端                                 |
  | **涉众利益** | 用户：希望能够根据日期和地点获得天气预报<br />系统：为用户提供天气预测情况 |
  | **基本路径** | 1. 用户选择日期和城市名称<br />2. 用户确认查询<br />3. 系统后端调用算法对未来七天天气情况进行预测<br />4. 系统将预测情况通过数据、图表形式在前端展示 |
  | **拓展路径** | 1. 用户选择日期不存在系统可预测范围内，提示用户<br />2. 用户输入城市名称不存在系统可预测范围内，提示用户<br />3. 后端处于计算中，提示用户等待 |
  | **字段列表** | 日期，城市名称                                               |
  | **备注**     |                                                              |

- 天气预测数据下载

  | 用例名称     | 天气预测数据下载                                             |
  | :----------- | ------------------------------------------------------------ |
  | **功能简述** | 将天气预测数据下载至本地                                     |
  | **用例编号** | 003                                                          |
  | **执行者**   | 具有该项权限的用户                                           |
  | **前置条件** | 用户登录系统，进入后台Dashboard模块                          |
  | **后置条件** | 用户可以进行下载数据的操作                                 |
  | **涉众利益** | 用户：希望能够根据日期和地点获得天气预报<br />系统：为用户提供天气预测情况 |
  | **基本路径** | 1. 用户选择日期和城市名称<br />2. 用户确认查询<br />3. 系统后端调用算法对未来七天天气情况进行预测<br />4. 系统将预测情况通过数据、图表形式在前端展示<br />5. 用户选择下载预测数据<br />6. 系统弹出下载框供用户选择数据文件下载位置 |
  | **拓展路径** | 1. 用户选择日期不存在系统可预测范围内，提示用户<br />2. 用户输入城市名称不存在系统可预测范围内，提示用户<br />3. 后端处于计算中，提示用户等待<br />4. 数据文件无法下载至本地，提示用户 |
  | **字段列表** | 日期，城市名称                                               |
  | **备注**     |                                                              |

- 用户管理

  | 用例名称     | 用户管理                                                     |
  | :----------- | ------------------------------------------------------------ |
  | **功能简述** | 对系统用户进行管理，包括对用户的增删改查操作                 |
  | **用例编号** | 004                                                          |
  | **执行者**   | 具有该项权限的用户                                           |
  | **前置条件** | 用户登录系统，进入后台User模块                               |
  | **后置条件** | 调用数据库的许可                                             |
  | **涉众利益** | 用户：希望能对系统用户名单进行管理操作<br />系统：希望具有用户管理功能 |
  | **基本路径** | 1. 用户选择要进行的操作（增删改查）<br />2. 用户根据提示输入操作所需的信息<br />3. 用户确认操作<br />4. 系统根据用户的操作对用户信息数据库进行更新<br />5. 系统将更改后的用户名单在前端展示 |
  | **拓展路径** | 用户操作失败，系统提示                                       |
  | **字段列表** | 用户名，密码，邮箱，角色，描述                               |
  | **备注**     |                                                              |

- 权限（角色）管理

  | 用例名称     | 权限（角色）管理                         |
  | :----------- | ---------------------------------------- |
  | **功能简述** | 通过对用户角色设置，实现对用户权限的管理 |
  | **用例编号** | 005                                         |
  | **执行者**   |   具有该权限的用户                                       |
  | **前置条件** |   用户登录系统，进入后台Role模块                                       |
  | **后置条件** |   调用数据库的许可                                       |
  | **涉众利益** |   用户：希望能够对系统用户权限进行管理<br />系统：希望具有细致的权限管理功能                                       |
  | **基本路径** |   1. 用户选择要进行的操作（增删改查）<br />2. 用户根据提示输入操作所需的信息<br />3. 用户确认操作<br />4. 系统根据用户的操作对角色信息数据库进行更新<br />5. 系统将更改后的角色名单在前端展示                                       |
  | **拓展路径** |    用户操作失败，系统提示                                      |
  | **字段列表** |     角色名称，描述，角色权限                                     |
  | **备注**     |                                          |

- 个人信息管理

    | 用例名称     | 个人信息管理                                                 |
    | :----------- | ------------------------------------------------------------ |
    | **功能简述** | 用户对个人信息进行查看与更改                                 |
    | **用例编号** | 006                                                          |
    | **执行者**   | 已登录用户                                                   |
    | **前置条件** | 用户登录系统，进入个人主页                                   |
    | **后置条件** | 用户可以进行个人信息的管理                                 |
    | **涉众利益** | 用户：希望能够查看与更改个人信息<br />系统：希望能够实现用户个人信息管理 |
    | **基本路径** | 1. 系统在前端展示用户个人信息<br />2. 用户选择对个人信息的更改 |
    | **拓展路径** | 用户未登录，提示用户                                         |
    | **字段列表** | 用户名，邮箱，头像                                           |
    | **备注**     |                                                              |


### 性能需求

#### 时间特性

- 网页的打开时间 < 1s
- 算法预测出结果所需时间 < 10s
- 数据库查询时间 < 0.1s

#### 适应性

在市面上常见的终端（智能手机、电脑等）的常见浏览器（Chrome、Firefox）上均能正常显示并运行

### 界面需求

用户界面是人与计算机之间的媒介。用户通过用户界面来与计算机进行信息交换。因此，用户界面的质量，直接关系到应用系统的性能能否充分发挥，能否使用户准确、高效、轻松、愉快地工作。所以软件的友好性、易用性对于软件系统至关重要。

#### 具体要求
1. 字体
微软雅黑（12至20）px，黑色/白色/蓝色（打印文字不在此限）。
2. 风格
采用全屏网页设计，扁平化、视差化的化繁为简的设计思维，让整个网站的整体性、统一性、灵活性、自适应性、流畅性得到了相对的提高，也使得平台的功能处理和管理能力在这些特点的加持之下得到综合性的展示。
3. 色值
主题色值：深蓝、白；
协调色值：灰、天蓝、黑；
文本色值：浅黑、天蓝，浅灰；
按钮色值：深蓝，天蓝；
线框色值：天蓝、灰。
4. 尺寸
在合理的布局下尽可能多的显示控件内的内容。
5. 布局
按照操作流程或浏览顺序自左至右、由上而下的排放各种控件，使界面整体协调、简洁、美观大方。
6. 自适应父对象的尺寸改变
控件应具有自适应父对象的尺寸改变的能力，当父对象的尺寸发生变化时，控件应能自动改变自己的尺寸并使界面保持整体协调，尽量减少因父对象的尺寸改变而带来的操作或浏览上的不便。

#### 项目原型图


![前台界面](https://codimd.s3.shivering-isles.com/demo/uploads/upload_43faaa4f55e6b453c26302030cb2c875.png)

<center>前台界面</center>

![后台登录界面](https://codimd.s3.shivering-isles.com/demo/uploads/upload_0055e1dc37b013dfbf629e1dc3e4b97c.png)

<center>后台登录界面</center>

![后台个人界面](https://codimd.s3.shivering-isles.com/demo/uploads/upload_247aef328f679675a62a83fccd9108d5.png)

<center>后台个人界面</center>

![后台主页](https://codimd.s3.shivering-isles.com/demo/uploads/upload_a14da9bfef4dab4ca42f89cb21c2dc4c.png)

<center>后台主页</center>

![用户管理界面](https://codimd.s3.shivering-isles.com/demo/uploads/upload_7ab44652563f81b760c189ffeac2dfd9.png)

<center>用户管理界面</center>

![新建（编辑）用户界面](https://codimd.s3.shivering-isles.com/demo/uploads/upload_b04c7264f518febabda7e061d99b4107.png)

<center>新建（编辑）用户界面</center>

![角色管理界面](https://codimd.s3.shivering-isles.com/demo/uploads/upload_13d17222ce280b78f7e1bd661e49d486.png)

<center>角色管理界面</center>

![新建（编辑）角色界面](https://codimd.s3.shivering-isles.com/demo/uploads/upload_458a806303b2dffd2e45abc25b92ea53.png)

<center>新建（编辑）角色界面</center>


    
### 接口需求

#### 软件接口

1. 用户、角色数据接口类，包括用户、角色数据的创建、更新、删除、查询等，该方法用于实现用户的注册、登录、权限判定、权限提升以及角色的增删改查权限设置、信息更新功能。 
3. 天气数据接口类，用于实现天气数据的查询功能
4. 功能选择接口类、包括功能模块的选择、切换，该方法用于实现应用向服器申请不同功能的更替。
5. 算法微服务接口。用于提供算法模型预测结果返回到后端的功能。

### 其他需求

1. 安全性
用户登录必须输入账号，及相应的正确密码。
2. 可维护性
开发过程对程序代码进行合理注释，增强程序的可读性，便于后续开发者了解代码结构，维护软件。
3. 可移植性
服务计算与客户端程序分离，封装好服务的计算接口，当后期移植到不同平台时，直接调用接口即可得到需要的结果，可与平台解耦。


## 数据流分析

![](https://codimd.s3.shivering-isles.com/demo/uploads/upload_c6550b1db0ea6889294528051a54f7d5.png)

 
 
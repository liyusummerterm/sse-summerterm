# 项目总结

## 引言

### 编写目的

气象数据分析及气象预测系统的开发已基本完成。编写此项目总结，以概括此次项目成果，归纳此次项目开发的进步与不足，总结收获与体会，充分利用好此次项目开发的宝贵经验，为我们在以后的项目中更好地实施与完成打下基础。

### 背景
项目名称：气象数据分析
软件名称：气象数据分析及气象预测系统
开发者：张璞 栗明磊 朱书勤 徐奕珂 程雨桐

### 参考资料

（不完整归纳）
- Vue Cli官网教程： 
https://cli.vuejs.org/
- National Oceanic and Atmospheric Administration：
https://www.noaa.gov/weather
- Ajax教程：
https://www.w3schools.com/xml/ajax_intro.asp
- EMD经验模态分析教程：
http://blog.sina.com.cn/s/blog_55954cfb0102e9y2.html
- LSTM长短期记忆人工神经网络教程：
https://easyai.tech/ai-definition/lstm/
- Hadoop官网教程：
http://hadoop.apache.org/
- Vue Router 路由搭建教程：
https://godbasin.github.io/vue-ebook/vueebook/7.html
- Web flash后台管理教程：
https://github.com/enilu/web-flash

## 实际开发结果

### 产品

最终开发得到一个具有相对完整功能的气象数据分析及气象预测系统。该系统前后端分离，模块之间耦合度低，数据处理高效准确，全方面提供良好的用户体验。

前端使用Vue.js + Vuex + webpack + websocket搭建，为用户提供良好的可视界面

后端使用Python Flask + websocket + RESTful API，提供了对于资源便捷的操作以及模块之间的低耦合度，方便后期拓展

算法使用Python Flask微服务 + Tensorflow + Keras + LSTM + EMD，数据处理高效，预测精准度高;

数据库使用MySQL + Redis，有效储存管理系统各项数据。

### 主要功能和性能

主要功能如图所示。

![架构图](https://codimd.s3.shivering-isles.com/demo/uploads/upload_9317c7fe46d9fa0234e93432a68d4ee8.png)

主要功能可分为前端、后端、运维部署和算法四个部分，其中：
- 前端
    - 前台首页查询
    提供首页上的天气数据查询功能，用户可以选择日期和城市，然后进行查询；预测出来的数据将通过websocket从后端发至浏览器，并且通过echarts和表格显示
    - 后台dashboard
    提供后台管理界面的功能，用户可以在dashboard进行如下操作：
        - 查询天气，并导出数据报表
        - 对于用户的增删改查
        - 对于角色的增删改查，并且对于角色进行细粒度的权限划分
        - 查看个人资料和更换头像
- 后端
    - 用户管理
    提供用户管理逻辑，对用户的信息、角色等进行增删改查
    - 角色管理
    提供角色管理逻辑，对角色的信息进行增删改查
    - 权限管理
    提供权限管理逻辑，对角色权限进行增删改查
    - RESTful API交互
    为后端功能提供RESTful API，便于进行资源的增删改查，且十分优雅
    - 数据库操作
    为后端几个管理模块提供统一的数据库操作接口
- 运维部署
    - 使用Softether配合nginx+ssl_preread实现多地址连接聚合防止运营商QoS&HE隧道QoS的GFW穿透
    - 使用microk8s搭建Kuberteres集群
    - 使用Jenkins进行与git集成的持续交付&持续部署
    - 使用Buildkit进行带缓存加速的容器镜像构建
    - 使用Helm进行容器配置文件管理
- 算法
    - 模型训练及验证
    读取地区的气象数据文件，用该地区全部数据训练TMAX、TMIN、TAVG、PRCP四种指标的模型，在训练过程中每次循环计算loss、mse和mae，并根据结果进行修正。最终     将四种模型分别存储以便后续使用。
    - 模型调用
    调用已训练模型，读取数据文件并选取预测开始日期的前20天数据作为参考，用已训练模型做出预测结果。

### 项目拓展创新

在实现项目指导文档要求基本任务与分支任务的基础上，本小组设计的气象数据分析及气象预测系统另具有以下创新点：

1. 拓展导出气象数据报表功能

    在实现用户查询气象预测功能，并在页面可视化展现预测数据的基础上，本项目拓展导出气象数据报表功能，即用户可以将需要的气象预测情况导出成csv格式文件并下载至本地，以满足不同用户对数据的需求，提升用户体验。
    
2. 权限划分精确到按钮粒度

    在用户权限管理模块的实现中，本系统采取了对用户分配角色、不同角色对应不同权限的模式。在角色的权限设置中，权限划分细致到每一个按钮，使得权限管理更为精确、灵活。

3. 使用Vue.js和Vuex
    
    由于本系统采取前后端分离的设计，具有模块之间耦合度低的优点。因此在前端开发中，使用Vue.js和Vuex，以便于进行数据绑定和数据状态管理，使得前端相对独立而利于系统整合与迭代。
    
4. 使用更具优势的预测算法
    
    在本系统的预测算法模块，获取历史气象数据后，通过对其进行EMD分解后再使用双层Lstm，使得预测结果具有更优秀的准确度，强化了本系统的气象预测这一主要功能。


### 基本流程

本项目开发基本流程为：

1. 需求分析与概要设计
2. 人员工作分配与时间规划
3. 分块开发与模块整合
4. 功能补充与系统测试
5. 项目总结与文档撰写

### 进度

项目进度情况如甘特图所示。

![](https://codimd.s3.shivering-isles.com/demo/uploads/upload_193a6cd8053a25540a32348be59b949e.png)


### 开发疲劳点

1. 使用spark清洗数据时，由于数据量较大（近40年，全世界3000+station每日的气象数据），因此即使使用了集群，运算的时间仍然比较长（两天左右）。
2. 在配置DevOps时，所使用组件的官方文档存在一些问题，甚至有些关于参数的描述是错误的，耗费了大量的时间去调试。
3. 开源项目本身的issue没有及时修复，导致在使用时出现了预期之外的错误，同样也需要大量时间调试。
4. 算法模型在训练时，由于要预测的城市比较多（30+），在训练模型时速度也比较慢。
5. LSTM网络的编写，本项目使用了两层LSTM网络，以及EMD分析，也耗费了一些调试的时间。
6. 利用vuex存储数据时，有一些预期外的表现。
7. 接触新技术时，需要大量时间去学习和探索，同样也是一个挑战。


## 开发工作评价

### 对生产效率的评价

小组分为前端、后端、算法、测试、运维、项目管理等部分，组长负责分配任务、检查进度，组员各司其职，按时完成每天的工作，每五天一个迭代，工作效率优良。

小组采取遇问题及时开组会、有进度及时提交仓库的安排管理方式，使得小组进度基本与计划相符，开发进展相对顺利流畅。

### 对产品质量的评价

所编写的代码基本实现完善，无明显影响用户使用的恶性bug，隐藏的bug有待进一步使用发现。

### 对技术方法的评价

在开发中运用了较多的技术方法，能够较好地将它们融入到项目的开发中，并且成体系地构建整个项目。

### 出错原因的分析

主要还是由于代码情况考虑不完善造成，例如缺少考虑边际条件、异常没有及时捕获等。另一方面，某些开源项目的官方文档更新不够及时，甚至存在一些错误。当按照这些文档部署时，就容易出错。

### 经验与教训

#### 人员分工

在今后的项目实践中，人员分工是首要考虑的问题。考虑到技术栈的问题以及学习的深度，本次项目分工的任务并不完全是均匀分配，因此存在进度不同步的情况。

#### 项目管理

要善用各种平台提供的项目管理工具，及时做好里程碑的制定和进度的持续跟踪，让一切都井井有条。

#### 开发计划

及时制定一个完善的开发计划是有效且必要的，并且根据项目迭代情况及时调整开发计划，实现随时跟踪。

#### 终身学习

在软件工程领域，新技术、新方法层出不穷，只有不断地将自己投身于学习中，我们才能保证紧随时代的步伐，并且不断完善自身的技术栈，拓展技术的深度和广度。正所谓：苟日新，日日新，又日新。

#### 团队协作

团队协作是十分重要的；好的协作可以事半功倍。

## 工作总结

总之，本次项目开发让我们这个团队学习到了不少东西，无论是集群的部署还是前后端开发，都是之前未曾涉足的领域。而这次的团队协作也比较良好，大家为了同一个目标各自分工，不断努力，通过实现一个个小目标，最终实现一个大的目标，这样的过程是给人带来极大的成就感的。

